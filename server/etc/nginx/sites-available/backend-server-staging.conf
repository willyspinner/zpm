# NOTE: with context of the nginx.conf, this is already inside the http block.
upstream backend_server{
    server 127.0.0.1:7200;
}

server {        # listen directive - states which port nginx is listening on
    server_name staging.shmrk.co;  # name of the server which will be the hostname in the client - so when the client requests willyserver.com, this will be stored.
    server_name_in_redirect on;


    # index.html
    location / {
         proxy_pass http://backend_server;
        #gzip on;
        #gzip_types text/css application/x-javascript text/javascript application/javascript;
        #proxy_set_header Host $server_name;
        proxy_set_header   X-Real-IP         $remote_addr;
      proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;
    }


    listen 443 ssl;


    ssl_certificate /etc/letsencrypt/live/staging.shmrk.co/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/staging.shmrk.co/privkey.pem; # managed by Certbot
}



server {
    if ($host = staging.shmrk.co) {
        return 301 https://$host$request_uri;
    } 

    server_name staging.shmrk.co;
    listen 80 ;
    return 404; 




}
